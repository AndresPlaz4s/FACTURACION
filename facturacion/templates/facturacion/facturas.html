{% extends 'facturacion/base.html' %}
{% load static %}

{% block title %}Facturas{% endblock %}

{% block content %}

<main class="contenedor-principal">

    <h1 class="titulo">FACTURAS</h1>

    <!-- ðŸ”Ž FILTRO POR FECHA -->
    <form method="GET" class="filtro-simple">
        <label for="fecha"><strong>Buscar por fecha:</strong></label>
        <input type="date" id="fecha" name="fecha" value="{{ fecha|default_if_none:'' }}">
        <button type="submit">Buscar</button>
    </form>

    <!-- ðŸ§¾ TABLA -->
    <section class="cuadro-facturas">
        <div class="contenedor-tabla">

            <table>
                <thead>
                    <tr>
                        <th>NÂ°</th>
                        <th>CÃ³digo</th>
                        <th>Cliente</th>
                        <th>Total</th>
                        <th>Fecha / Hora</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                
                <tbody>
                    {% for factura in ventas %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ factura.pk }}</td>
                        <td>{{ factura.venta.cliente.nombre }}</td>
                        <td>$ {{ factura.total_factura }}</td>
                        <td>{{ factura.fecha|date:"d/m/Y H:i" }}</td>

                        <td class="btns">
                            <a href="{% url 'facturacion:factura_pdf' factura.venta.id %}" target="_blank">
                                <i class="fa-solid fa-print"></i>
                            </a>
                            <button class="btn-modal" data-id="{{ factura.venta.id }}">
                                <i class="fa-solid fa-eye"></i>
                            </button>
                        </td>
                    </tr>

                    {% empty %}
                    <tr>
                        <td colspan="6" style="text-align:center;">No hay facturas para esta fecha.</td>
                    </tr>
                    {% endfor %}
                </tbody>

            </table>

        </div>
    </section>

</main>

<!-- MODAL -->
<div id="modalFactura" class="modal hidden">
    <div class="modal-contenido">
        <span class="cerrar">&times;</span>
        <div id="modalBody"></div>
    </div>
</div>

<script src="{% static 'js/facturas.js' %}"></script>

{% endblock %}
